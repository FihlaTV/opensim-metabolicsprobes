<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>OpenSim Documentation : How IAA Works</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body>
        <div id="page">
            <div id="main">
                <div id="main-header" class="pageSectionHeader">
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            OpenSim Documentation : How IAA Works
                        </span>
                    </h1>

                    <div class="page-metadata">
                        <p>This page last changed on Apr 29, 2013 by <font color="#0050B2">tkuchida</font>.</p>
                    </div>
                </div>

                <div id="content" class="view">
                    <div id="main-content" class="wiki-content group">
                    <p>The topics covered in this section include:</p><p><div>
<ul>
    <li><a href='#HowIAAWorks-EquationsofMotion'>Equations of Motion</a></li>
    <li><a href='#HowIAAWorks-ConstraintstoModelContact'>Constraints to Model Contact</a></li>
    <li><a href='#HowIAAWorks-Superposition'>Superposition</a></li>
</ul></div></p><h2 id="HowIAAWorks-EquationsofMotion">Equations of Motion</h2><p>The equations of motion (EOMs) of an OpenSim model are given by:</p>
 
 
<style>
    #math837887599 .typeset {
        color: black
    }
    #math837887599 {
        font-size: 150%;
        margin: 1em 0px;
    }
    #jsMath_button, #jsMath_message, #jsMath_Warning {
        display: none;
    }
</style>
 
<script type="text/javascript" src="/includes/js/jsMath/plugins/noImageFonts.js">//<![CDATA[


//]]>
</script>
<script type="text/javascript" src="/includes/js/jsMath/jsMath.js">//<![CDATA[


//]]>
</script>
 
<span id="math837887599" class="math">
  \left[ M \right] \ddot{q} = G(q) + V(q,\dot{q}\,) + S(q,\dot{q}\,) + \left[ R \right] f
</span>
 
<script type="text/javascript">//<![CDATA[

//check for use of this macro elsewhere on the page so that we only call jsMath once
 if (typeof mathFormulaDetected == 'undefined') {
    var mathFormulaDetected = false;
}
jQuery(document).ready(function() {
    if (!mathFormulaDetected) {
        jsMath.ProcessBeforeShowing();
        mathFormulaDetected = true;
    }
});

//]]>
</script><p>where <em>M</em> is the mass matrix, <em>q</em> are the generalized coordinates, <em>G</em> is the generalized force due gravity, <em>V</em> is the force due to Coriolis and centrifugal effects, <em>S</em> is the resulting generalized force due to contact elements, and <em>f</em> is a muscle force or any other applied force transformed to a generalized force via a force transmission matrix, <em>R</em> (which, for a muscle, contains its moment arms). The induced acceleration of any force contributor is simply</p>
 
 
<style>
    #math543021969 .typeset {
        color: black
    }
    #math543021969 {
        font-size: 150%;
        margin: 1em 0px;
    }
    #jsMath_button, #jsMath_message, #jsMath_Warning {
        display: none;
    }
</style>
 
<script type="text/javascript" src="/includes/js/jsMath/plugins/noImageFonts.js">//<![CDATA[


//]]>
</script>
<script type="text/javascript" src="/includes/js/jsMath/jsMath.js">//<![CDATA[


//]]>
</script>
 
<span id="math543021969" class="math">
  \ddot{q}_i = \left[ M \right]^{-1} \left\{ F_i \right\}
</span>
 
<script type="text/javascript">//<![CDATA[

//check for use of this macro elsewhere on the page so that we only call jsMath once
 if (typeof mathFormulaDetected == 'undefined') {
    var mathFormulaDetected = false;
}
jQuery(document).ready(function() {
    if (!mathFormulaDetected) {
        jsMath.ProcessBeforeShowing();
        mathFormulaDetected = true;
    }
});

//]]>
</script><p>where <em>F<sub>i</sub></em> is the contribution of any force (gravitiation, Coriolois, contact, or muscle) to the acceleration. For example, calculating the acceleration caused by the application of a muscle force would involve solving</p>
 
 
<style>
    #math252992475 .typeset {
        color: black
    }
    #math252992475 {
        font-size: 150%;
        margin: 1em 0px;
    }
    #jsMath_button, #jsMath_message, #jsMath_Warning {
        display: none;
    }
</style>
 
<script type="text/javascript" src="/includes/js/jsMath/plugins/noImageFonts.js">//<![CDATA[


//]]>
</script>
<script type="text/javascript" src="/includes/js/jsMath/jsMath.js">//<![CDATA[


//]]>
</script>
 
<span id="math252992475" class="math">
  \ddot{q}_m = \left[ M \right]^{-1} \left[ R \right] f_m
</span>
 
<script type="text/javascript">//<![CDATA[

//check for use of this macro elsewhere on the page so that we only call jsMath once
 if (typeof mathFormulaDetected == 'undefined') {
    var mathFormulaDetected = false;
}
jQuery(document).ready(function() {
    if (!mathFormulaDetected) {
        jsMath.ProcessBeforeShowing();
        mathFormulaDetected = true;
    }
});

//]]>
</script><p>An induced acceleration analysis with state-dependent contact forces represented by <em>S</em> (including externally-applied forces as functions of time) poses unique challenges because these forces are not independent of the other forces acting on the model. In most cases, <em>S</em> represents the reaction forces due to the model's interaction with its environment. During walking, for example, the ground reaction force is the force applied to the model by the ground, which includes the contributions of gravity, velocity, and muscle forces to the reaction measured by a force plate. Since internal forces, such as muscles, do not directly accelerate the center of mass (it is the reaction force with the environment that causes the mass center acceleration), it is also necessary to determine how an internal force contributes to an external reaction force. Therefore, in computing the acceleration of the system due to individual force contributors, it is essential to decompose the external reaction force in order to include only the partial (induced) contribution of each internal force to the external reaction force and to the acceleration of the system. In this case, the acceleration induced by a single force contributor is:</p>
 
 
<style>
    #math2108740455 .typeset {
        color: black
    }
    #math2108740455 {
        font-size: 150%;
        margin: 1em 0px;
    }
    #jsMath_button, #jsMath_message, #jsMath_Warning {
        display: none;
    }
</style>
 
<script type="text/javascript" src="/includes/js/jsMath/plugins/noImageFonts.js">//<![CDATA[


//]]>
</script>
<script type="text/javascript" src="/includes/js/jsMath/jsMath.js">//<![CDATA[


//]]>
</script>
 
<span id="math2108740455" class="math">
  \ddot{q}_i = \left[ M \right]^{-1} \left\{ F_i + S_i \right\}
</span>
 
<script type="text/javascript">//<![CDATA[

//check for use of this macro elsewhere on the page so that we only call jsMath once
 if (typeof mathFormulaDetected == 'undefined') {
    var mathFormulaDetected = false;
}
jQuery(document).ready(function() {
    if (!mathFormulaDetected) {
        jsMath.ProcessBeforeShowing();
        mathFormulaDetected = true;
    }
});

//]]>
</script><p>where <em>F<sub>i</sub></em> is the force contributor we are interested in analyzing, be it gravity, muscle forces, or ideal torque actuators. In this case, both the induced acceleration and the partial (induced) contact force, <em>S<sub>i</sub></em>, are unknown.</p><p>There are two fundamental approaches for solving this problem. One approach is to slightly augment (or perturb) the force of interest, <em>F<sub>i</sub></em>, (by 1N) and integrate the equations of motion a small interval forward in time to determine the corresponding change in the reaction force. This method is commonly referred to as a <em>perturbation analysis</em>. This approach yields the sensitivity of the contact force due to a unit change in force, and multiplying this change by the applied force yields its induced reaction force. There are several issues with this approach, including the need to use very stiff contact springs in order for the contact force sensitivity to remain linear over a small integration interval, which makes forward integration of the system dynamics slow. Second, results are sensitive to the selection of the contact stiffness and the time interval over which the change in contact force is evaluated. Applying stiff 3-dimensional linear and torsional springs approximates rigid constraints imposed by a weld constraint, effectively eliminating the 6 degrees of freedom at the point of contact.</p><p>The other approach, which is the current implementation of the Induced Acceleration Analysis, replaces the contribution of contact with an appropriate kinematic constraint. Kinematic constraint reaction forces are resolved simultaneously with the constrained equations of motion:</p>
 
 
<style>
    #math1529691999 .typeset {
        color: black
    }
    #math1529691999 {
        font-size: 150%;
        margin: 1em 0px;
    }
    #jsMath_button, #jsMath_message, #jsMath_Warning {
        display: none;
    }
</style>
 
<script type="text/javascript" src="/includes/js/jsMath/plugins/noImageFonts.js">//<![CDATA[


//]]>
</script>
<script type="text/javascript" src="/includes/js/jsMath/jsMath.js">//<![CDATA[


//]]>
</script>
 
<span id="math1529691999" class="math">
  <p>\begin{align}</p><p>\left[ M \right] \ddot{q} + \left[ C \right]^{\mathrm{T}} \lambda &amp;= G(q) + V(q,\dot{q}\,) + \left[ R \right] f \\</p><p>\left[ C \right] \ddot{q} &amp;= B(t,q,\dot{q}\,)</p><p>\end{align}</p>
</span>
 
<script type="text/javascript">//<![CDATA[

//check for use of this macro elsewhere on the page so that we only call jsMath once
 if (typeof mathFormulaDetected == 'undefined') {
    var mathFormulaDetected = false;
}
jQuery(document).ready(function() {
    if (!mathFormulaDetected) {
        jsMath.ProcessBeforeShowing();
        mathFormulaDetected = true;
    }
});

//]]>
</script><p>where the constraint matrix, <em>C</em>, maps from components of constraint reaction forces
 
 
<style>
    #math421501035 .typeset {
        color: black
    }
    #math421501035 {
        font-size: 150%;
        margin: 1em 0px;
    }
    #jsMath_button, #jsMath_message, #jsMath_Warning {
        display: none;
    }
</style>
 
<script type="text/javascript" src="/includes/js/jsMath/plugins/noImageFonts.js">//<![CDATA[


//]]>
</script>
<script type="text/javascript" src="/includes/js/jsMath/jsMath.js">//<![CDATA[


//]]>
</script>
 
<span id="math421501035" class="math">
  \lambda
</span>
 
<script type="text/javascript">//<![CDATA[

//check for use of this macro elsewhere on the page so that we only call jsMath once
 if (typeof mathFormulaDetected == 'undefined') {
    var mathFormulaDetected = false;
}
jQuery(document).ready(function() {
    if (!mathFormulaDetected) {
        jsMath.ProcessBeforeShowing();
        mathFormulaDetected = true;
    }
});

//]]>
</script>, to a system generalized force (replacing the applied external force or compliant contact model, <em>S</em>). The kinematic constraints on positions and velocities are differentiated so that they are expressed in terms of conditions on the coordinate accelerations. The left-hand side contains the accelerations and the right-hand side defines the conditions on accelerations described as a function, <em>B</em>, of time, system position, and/or system velocity.</p><p>Using this approach with kinematic constraints does not require forward integration to estimate the response of contact as in the perturbation method, and results in a computationally efficient and precise analysis.</p><h2 id="HowIAAWorks-ConstraintstoModelContact">Constraints to Model Contact</h2><p>OpenSim provides several constraint types that are supported with an Induced Acceleration Analysis, including Point, Weld, and RollingOnSurface constraints, as summarized in the figure below. A Point constraint forces two points on separate bodies to remain coincident, but allows free relative rotation about that point, similar to a ball-and-socket joint. A Weld is similar, but also constrains the orientation of the two bodies to remain fixed to one another. A RollingOnSurface describes a constraint on a rolling body that is in contact with a plane defined on another body (Hamner et al., 2010). Translations of the point of contact normal to the plane are constrained only if the point of contact penetrates into the surface of the plane; otherwise, the point is free to lift off. When the point is in contact with the plane, its velocity relative to the plane is constrained to be zero in the plane. Finally, when in contact with the plane, the rolling body is constrained not to rotate about the normal of the surface (i.e., no twisting) at the point of contact. These four individual constraints define the kinematic behavior known as <em>pure rolling</em>. The point at which the constraint is applied is obtained from the point of application of a corresponding external force being applied during a forward simulation. In the case of the Weld, the orientations of the bodies are set according to current values of the generalized coordinates.</p><p style="text-align: center;"><img class="confluence-embedded-image image-center" width="500" src="attachments/3376226/3737321.jpg" data-image-src="attachments/3376226/3737321.jpg"><strong>Figure: Available constraint types for an Induced Acceleration Analysis</strong></p><h2 id="HowIAAWorks-Superposition">Superposition</h2><p>When analyzing the results of an induced acceleration analysis, it is important to test whether the sum of the accelerations induced by each muscle and by gravity is equal to the total acceleration. Since the induced acceleration analysis determines the acceleration of each actuator to the total acceleration, summing the induced acceleration of all the actuators should give the total acceleration. For example, you may want to compute the sum of the contributions of each muscle force and other forces to mass center acceleration and compare that to the net acceleration of the mass center (see Liu et al., 2006 and Hamner et al., 2010). The output file for each coordinate or body acceleration contains the &quot;total&quot; or summed induced accelerations from all of the actuators. This total acceleration can be compared to the original accelerations of joints or the mass center which can be obtained by running the &quot;Kinematics&quot; analysis or &quot;Body Kinematics&quot; analysis in OpenSim. OpenSim also can report constraint reaction forces, such that the induced reaction forces can be summed and compared to the total simulated and/or measured reaction forces to test the accuracy of the constraint in representing the contact conditions.</p><p> </p><div class="panel" style="background-color: white;border-color: gray;border-style: solid;border-width: 5px;"><div class="panelContent" style="background-color: white;">
<p>Next: <a href="How%2Bto%2BUse%2BIAA.html">How to Use IAA</a></p><p>Previous: <a href="Inputs%2Band%2BOutputs%2Bfor%2BIAA.html">Inputs and Outputs for IAA</a></p><p>Home: <a href="Induced%2BAcceleration%2BAnalysis.html">Induced Acceleration Analysis</a></p>
</div></div>
                    </div>

                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/3376226/3737322.docx">IAA Equations.docx</a> (application/vnd.openxmlformats-officedocument.wordprocessingml.document)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/3376226/3737321.jpg">IAA Figure.jpg</a> (image/jpeg)
                                <br/>
                                                    </div>
                    </div>
                    
                                                      
                </div>             </div> 
            <div id="footer" style="background: url(http://simtk-confluence.stanford.edu:8080/images/border/border_bottom.gif) repeat-x;">
                <p><small>Document generated by Confluence on Feb 24, 2014 09:28</small></p>
            </div>
        </div>     </body>
</html>
