<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>OpenSim Documentation : Getting Started with Scaling</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body>
        <div id="page">
            <div id="main">
                <div id="main-header" class="pageSectionHeader">
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            OpenSim Documentation : Getting Started with Scaling
                        </span>
                    </h1>

                    <div class="page-metadata">
                        <p>This page last changed on Mar 29, 2013 by <font color="#0050B2">jenhicks</font>.</p>
                    </div>
                </div>

                <div id="content" class="view">
                    <div id="main-content" class="wiki-content group">
                    <div class="wiki-content" style="margin-left: 0.0px;"><p>The Scale Tool alters the anthropometry of a model so that it matches a particular subject as closely as possible. Scaling is typically performed by comparing experimental marker data to virtual markers placed on a model. In addition to scaling a model, the Scale Tool can be used to adjust the locations of virtual markers so that they better match the experimental data.</p><p>The Scale Tool is accessed by selecting <strong>Tools → Scale Model…</strong> from the OpenSim main menu bar. Like all tools, the operations performed by the Scale Tool apply to the current model.</p><p><div>
<ul>
    <li><a href='#GettingStartedwithScaling-Overview'>Overview</a></li>
    <li><a href='#GettingStartedwithScaling-SettingsFiles'>Settings Files</a></li>
    <li><a href='#GettingStartedwithScaling-Inputs'>Inputs</a></li>
    <li><a href='#GettingStartedwithScaling-Outputs'>Outputs</a></li>
    <li><a href='#GettingStartedwithScaling-BestPracticesandTroubleshooting'>Best Practices and Troubleshooting</a></li>
<ul>
    <li><a href='#GettingStartedwithScaling-DataCollectionandOtherPreparation'>Data Collection and Other Preparation:</a></li>
    <li><a href='#GettingStartedwithScaling-ScaleSettings'>Scale Settings:</a></li>
    <li><a href='#GettingStartedwithScaling-EvaluatingyourResults'>Evaluating your Results:</a></li>
    <li><a href='#GettingStartedwithScaling-TroubleshootingTips'>Troubleshooting Tips:</a></li>
</ul>
    <li><a href='#GettingStartedwithScaling-VideoTutorials'>Video Tutorials</a></li>
</ul></div></p><h2 id="GettingStartedwithScaling-Overview">Overview</h2><p>The figure below shows the required inputs and outputs for the Scale Tool. Each is described in more detail in the following sections.</p><p><img class="confluence-embedded-image" src="attachments/3376179/3737619.png" data-image-src="attachments/3376179/3737619.png"></p><p><strong>Inputs and Outputs of the Scale Tool.</strong> Experimental data are shown in <span style="color: rgb(0,128,0);">green</span>; OpenSim files (.osim) are shown in <span style="color: rgb(128,0,0);">red</span>; settings files are shown in <span style="color: rgb(0,0,255);">blue</span>.</p><div class='panelMacro'><table class='infoMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/information.png" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><p>The file names are examples that can be found in the Models/Gait2354_Simbody directory installed with the OpenSim distribution.</p></td></tr></table></div><h2 id="GettingStartedwithScaling-SettingsFiles">Settings Files</h2><p>The <strong><span style="color: rgb(0,0,255);">subject01_Setup_Scale.xml</span></strong> file is the setup file for the Scale Tool. It contains settings, described in detail in <a href="How%2BScaling%2BWorks.html">How Scaling Works</a>. The setup file can include the following information:</p><ul><li><span style="color: rgb(0,0,255);"><strong>ScaleTasks</strong></span>: Inverse kinematics tasks for the Scale Tool. In addition to scaling the model, the Scale Tool moves the virtual markers on the model so that their positions match the experimental marker locations. To do this, the Scale Tool must position the model so that it best matches the position of the subject. This requires an inverse kinematics problem to be solved. This file contains the inverse kinematics tasks describing which virtual and experimental markers should be matched up during the inverse kinematics phase. The file also contains marker weights, which are relative and determine how &quot;well&quot; the virtual markers track experimental markers (a larger weight will result in less error between the corresponding virtual and experimental marker positions).</li><li><span style="color: rgb(0,0,255);"><strong>ScaleMeasurementSet</strong></span>: Measurement set for the Scale Tool. It contains pairs of experimental markers, the distance between which are used to scale the generic musculoskeletal model. </li><li><span style="color: rgb(0,0,255);"><strong>ScaleScaleSet</strong></span> Scale set for the Scale Tool. It contains a set of manual scale factors to be applied to the generic musculoskeletal model.</li></ul><div class='panelMacro'><table class='infoMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/information.png" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><p>As of 3.0.1 these settings are contained in a single file. If you had old setups with multiple files, they will be merged upon Open/Save of settings in the Scale Tool.</p></td></tr></table></div><p><span style="color: rgb(0,0,255);"><strong>ScaleMarkerSet.xml</strong></span>: Marker set for the Scale Tool. It contains the set of virtual markers that are placed on the body segments of the model.</p><h2 id="GettingStartedwithScaling-Inputs">Inputs</h2><p>Two data files are required by the Scale Tool:</p><p><span style="color: rgb(0,128,0);"><strong>subject01_static.trc</strong></span>: Experimental marker trajectories for a static trial. A static trial is usually several seconds of data with the subject posed in a known static position. A segment of a regular motion file can be used as a static trial if desired, but this is not typically done. The static pose should include the subject wearing the full marker set. The marker trajectories are specified in the global frame. You can find more information about collecting and preparing motion data in the section on <a href="Preparing%2BYour%2BData.html">Preparing Your Data</a>.</p><p><span style="color: rgb(128,0,0);"><strong>gait2354_simbody.osim</strong></span>: OpenSim musculoskeletal model. This generic model will be scaled to match the anthropometry of your subject.</p><p>You can also provide an additional, optional file:</p><p><span style="color: rgb(128,0,0);"><strong>subject01_static.mot</strong></span>: Experimental generalized coordinate values (joint angles) for a trial obtained from alternative motion capture devices or other specialized algorithms. You can specify coordinate weights in the Tasks file, if joint angles are known a priori. Coordinate weights are also relative and determine how &quot;well&quot; a joint angle will track the specified angle.</p><h2 id="GettingStartedwithScaling-Outputs">Outputs</h2><p>The Scale Tool generates a single file:</p><p><span style="color: rgb(128,0,0);"><strong>subject01_simbody.osim</strong></span>: OpenSim musculoskeletal model scaled to the dimensions of the subject.</p><h2 id="GettingStartedwithScaling-BestPracticesandTroubleshooting">Best Practices and Troubleshooting</h2><p><h4 id="GettingStartedwithScaling-DataCollectionandOtherPreparation">Data Collection and Other Preparation:</h4><ol><li>When collecting data, take pictures of your subjects in the static pose. These pictures are valuable for evaluating the results of the Scale Tool.</li><li>Measure subject specifics, like height, mass, body segment lengths, mass distribution (if DXA is available), and strength (if a Biodex is available). You can use this data, along with marker positions, to best match the generic model to a specific subject.</li><li>Have your subjects perform movements to calculate functional joint centers at the hip, knee, ankle, and/or shoulders, and append the joint centers to your static trial data (see <a href="http://simtk-confluence.stanford.edu:8080/display/OpenSim/Associating+Data+with+a+Motion">Associating Data with a Motion</a>).</li><li>These are just a few tips. Also review our full guide to <a href="http://simtk-confluence.stanford.edu:8080/display/OpenSim/Collecting+Experimental+Data">Collecting Experimental Data</a>.</li></ol><h4 id="GettingStartedwithScaling-ScaleSettings">Scale Settings:</h4><ol><li>Rely on markers that correspond to anatomical landmarks and functional joint centers (FJC) to position and scale the generic model.<br /><ol><li>See <a href="http://simtk-confluence.stanford.edu:8080/display/OpenSim/How+to+Use+the+Scale+Tool">How to Use the Scale Tool</a> for information about defining the measurement set for scaling and setting weights when positioning the model in the static pose.</li></ol></li><li>Some segments, like the pelvis and torso, are often best scaled non-uniformly. For example, see the torso scale settings in the section on the Scale Factors Pane in <a href="http://simtk-confluence.stanford.edu:8080/display/OpenSim/How+to+Use+the+Scale+Tool">How to Use the Scale Tool</a>.</li><li>Review <a href="http://simtk-confluence.stanford.edu:8080/display/OpenSim/How+Scaling+Works">How Scaling Works</a> for more information about Scale Settings.</li></ol><h4 id="GettingStartedwithScaling-EvaluatingyourResults">Evaluating your Results:</h4><ol><li>Scaling a model is an iterative process. Use the &quot;preview static pose&quot; option in the GUI. See the section on &quot;Previewing Scale&quot; in the <a href="http://simtk-confluence.stanford.edu:8080/display/OpenSim/How+to+Use+the+Scale+Tool">How to Use the Scale Tool</a> section for more information. After running preview, perform steps 2 to 5 described below.</li><li>Check the &quot;Messages&quot; window, which has information about the results of scaling, including the overal RMS marker error and the maximum marker error.<br /><ol><li>In general, maximum marker errors for bony landmarks should be less than 2 cm.</li><li>RMS error should typically be less than 1 cm.</li><li>Pay close attention to errors in the bony landmark and FJC markers when assessing the quality of your scaling results.</li></ol></li><li>Visualize the scaled model's anatomical marker positions relative to the corresponding experimental markers to see how well the model &quot;fits&quot; the data. Use the pictures you took to assess the results, comparing the joint angles in the &quot;Coordinates&quot; window to the angles you observe in the pictures.<br /><ol><li>Do the hip, knee, and ankle angles after scaling match what you observe in the picture?</li><li>Are there any large mismatches between experimental and model markers? Can these mismatches be explained by examining the pictures you took?</li><li>If pictures aren't available, use what you know about a typical static pose capture. For example, the ankle angle is generally less than 5º and hip flexion angle is less than 10º.</li><li>Again, pay close attention to errors in the landmark and FJC markers when assessing the quality of your scaling results.</li></ol></li><li>After examining the &quot;Messages&quot; window and performing a visual comparison, adjust the virtual markers and marker weightings to improve your results.<br /><ol><li>Again, avoid adjusting the positions of the landmark and FJC virtual markers to match the experimental markers.</li></ol></li><li>Once you've adjusted the virtual marker positions and the scale settings, preview the new static pose. Reassess your results using steps 2 to 4 above. Once you are happy with your results, hit &quot;Run&quot; to generate a scaled model and adjust the virtual markers on the model to match all of the experimental markers.</li></ol><h4 id="GettingStartedwithScaling-TroubleshootingTips">Troubleshooting Tips:</h4><ol><li>It is common to iterate through Scale and Inverse Kinematics to fine-tune segment dimensions and marker positions that yield low marker errors for the task of interest.</li><li>Use coordinate tasks (Static Pose Weights) to set joint angles for troublesome joints that are very sensitive to how the markers are placed (commonly the ankle joint and lumbar joint). For example, if it is known that the foot is flat, an ankle angle can be provided and then the markers can be adjusted in order to match the known pose.</li><li>If using coordinates from a motion capture system, make sure that the joint/coordinate definitions match—otherwise, you may cause more harm than good.</li><li>The model has a built-in assumption that the global Y-axis is up. If your data doesn't fit this assumption, then consider transforming your data. You can use <a href="http://simtk-confluence.stanford.edu:8080/display/OpenSim/Previewing+Motion+Capture+%28Mocap%29+Data">Previewing Motion Capture (Mocap) Data</a> to determine the proper transform to apply.</li></ol></p><h2 id="GettingStartedwithScaling-VideoTutorials">Video Tutorials</h2><p>Setting up the scale tool:</p><p><iframe class="youtube-player" type="text/html" style="width: 400px; height: 300px"
	src="http://www.youtube.com/embed/V5f7OMkfRBs" frameborder="0">
</iframe>
    
</p><p>Evaluating your results:</p></div><div class="pageSection group"><iframe class="youtube-player" type="text/html" style="width: 400px; height: 300px"
	src="http://www.youtube.com/embed/7STRMJefzpI" frameborder="0">
</iframe>
    
<p> </p><div class="panel" style="background-color: white;border-color: gray;border-style: solid;border-width: 5px;"><div class="panelContent" style="background-color: white;">
<p>Next: <a href="How%2BScaling%2BWorks.html">How Scaling Works</a></p><p>Home: <a href="Scaling.html">Scaling</a></p>
</div></div><p> </p></div>
                    </div>

                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/3376179/5046335.png">Scale.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/3376179/5046336.png">Scale.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/3376179/3737619.png">Scale.png</a> (image/png)
                                <br/>
                                                    </div>
                    </div>
                    
                                                      
                </div>             </div> 
            <div id="footer" style="background: url(http://simtk-confluence.stanford.edu:8080/images/border/border_bottom.gif) repeat-x;">
                <p><small>Document generated by Confluence on Feb 24, 2014 09:27</small></p>
            </div>
        </div>     </body>
</html>
