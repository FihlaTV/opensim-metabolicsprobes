<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <title>OpenSim Documentation : Getting Started with Forward Dynamics</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body>
        <div id="page">
            <div id="main">
                <div id="main-header" class="pageSectionHeader">
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            OpenSim Documentation : Getting Started with Forward Dynamics
                        </span>
                    </h1>

                    <div class="page-metadata">
                        <p>This page last changed on Sep 11, 2013 by <font color="#0050B2">jenhicks</font>.</p>
                    </div>
                </div>

                <div id="content" class="view">
                    <div id="main-content" class="wiki-content group">
                    <div class="wiki-content" style="margin-left: 0.0px;"><p>Given the controls (e.g., muscle excitations) computed by the Computed Muscle Control <span style="color: rgb(0,0,0);">(CMC) or another approach, the Forward </span>Dynamics Tool can drive a forward dynamic simulation. A forward dynamics simulation is the solution (integration) of the differential equations that define the dynamics of a musculoskeletal model. By focusing on specific time intervals of interest, and by using different analyses, more detailed biomechanical data for the trial in question can be collected.</p><p>To launch the Forward Dynamics Tool select <strong>Forward Dynamics…</strong> from the <strong>Tools</strong> menu. The <strong>Forward Dynamics Tool</strong> dialog, like all other OpenSim tools, operates on the <em>Current Model</em> open and selected in OpenSim.</p><p><div>
<ul>
    <li><a href='#GettingStartedwithForwardDynamics-Overview'>Overview</a></li>
    <li><a href='#GettingStartedwithForwardDynamics-Inputs'>Inputs</a></li>
    <li><a href='#GettingStartedwithForwardDynamics-Outputs'>Outputs</a></li>
    <li><a href='#GettingStartedwithForwardDynamics-BestPracticesandTroubleshootingTips'>Best Practices and Troubleshooting Tips</a></li>
</ul></div></p><h2 id="GettingStartedwithForwardDynamics-Overview">Overview</h2><p>The figure shows the required inputs and outputs for the Forward Dynamics Tool. Each is described in more detail in the following sections.</p><p><img class="confluence-embedded-image" width="400" src="attachments/3376188/3737101.png" data-image-src="attachments/3376188/3737101.png"></p><p><strong>Inputs and Outputs of the Forward Dynamics Tool.</strong> Experimental data are shown in <span style="color: rgb(0,204,153);">green</span>; OpenSim files (.osim) are shown in <span style="color: rgb(165,0,33);">red</span>; settings files are shown in <span style="color: rgb(51,102,255);">blue</span>; files generated by the workflow are shown in <span style="color: rgb(128,0,128);">purple</span>.</p><div class='panelMacro'><table class='infoMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="images/icons/emoticons/information.png" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><p>The file names are examples that can be found in the examples/Gait2354_Simbody directory installed with the OpenSim distribution. These inputs correspond to a typical OpenSim workflow and may be different for your own research application.</p></td></tr></table></div><h2 id="GettingStartedwithForwardDynamics-Inputs">Inputs</h2><p>Four data files are used as input by the Forward Dynamics Tool:</p><p><span style="color: rgb(128,0,128);"><strong>subject01_walk1_controls.xml</strong></span>: Contains the time histories of the model controls (e.g., muscle excitations) to the muscles and/or joint torques. It is possible to specify the controls as .sto files instead, with columns corresponding to desired excitations. This file may be generated by the user, the Static Optimization Tool, or the Computed Muscle Control Tool. If no controls are provided, they are assumed to be zero for any actuators in the model.</p><p><span style="color: rgb(128,0,128);"><strong>subject01_walk1_states.sto</strong></span>: Contains the time histories of model states, including joint angles, joint speeds, muscle activations, muscle fiber lengths, and more. These states are used by the Forward Dynamics Tool to set the initial states of the model for forward integration. If you are running a forward simulation using the controls from CMC, you should specify the states file outputted from CMC here. Muscle states can be estimated by solving for tendon and muscle fiber force equilibrium when the <em>Solve for equilibrium for actuator states</em> is checked.</p><ul><li>If you are running the forward tool in the GUI and no initial states files is specified, the simulation will start from the model's current pose. </li><li>If you are running the forward tool from the command line and no initial states file is specified, the simulation will begin from the default pose of the model. </li></ul><p><span style="color: rgb(0,204,153);"><strong>subject01_walk1_grf.xml</strong></span>: An .xml file describing the external loads applied, based (for example) on measured ground reaction forces that should be applied to the model during the simulation.</p><p><span style="color: rgb(165,0,33);"><strong>subject01_simbody_adjusted.osim</strong></span>: Subject-specific OpenSim model generated by scaling a generic model with the Scale Tool or by other means, along with an associated marker set containing adjusted virtual markers. The model must include inertial parameters (segment masses, etc.).</p><p>The <span style="color: rgb(51,102,255);"><strong>subject01_Setup_Forward.xml</strong></span> file is the setup file for the Forward Dynamics Tool. It contains settings, as described in <a href="How%2Bto%2BUse%2Bthe%2BForward%2BDynamics%2BTool.html">How to Use the Forward Dynamics Tool</a>, and refers to another settings file, <span style="color: rgb(51,102,255);"><strong>gait2354_CMC_Actuators.xml</strong></span>, which contains a set of actuators that supplement the muscles of the model. Refer to <a href="http://simtk-confluence.stanford.edu:8080/display/OpenSim/Computed+Muscle+Control" rel="nofollow">Computed Muscle Control</a> for more details. These actuators must be included in the forward simulation so that the CMC solution can be reproduced.</p><h2 id="GettingStartedwithForwardDynamics-Outputs">Outputs</h2><p>The Forward Dynamics Tool generates results in a folder specified in the setup file.</p><p><span style="color: rgb(128,0,128);"><strong>Results</strong></span>: Additional data can be generated and written to files by adding analyses to the Forward Dynamics Tool. These analyses are specified in the setup file (<span style="color: rgb(51,102,255);"><strong>subject01_Setup_Forward.xml</strong></span>) and are discussed in the <a href="Analyses.html">Analyses</a> section.</p><h2 id="GettingStartedwithForwardDynamics-BestPracticesandTroubleshootingTips" class="pageSection group">Best Practices and Troubleshooting Tips</h2><p><ol><li>Forward dynamics simulations are sensitive to initial conditions, and it is good practice to double-check that the initial conditions are appropriate for the desired simulation.</li><li>If the Forward Dynamics Tool fails gracefully (i.e., without crashing OpenSim) or the output of the Tool drifts too much (i.e., the model &quot;goes crazy&quot;), shorten the interval over which the Forward Dynamics Tool runs (i.e., make initial_time and final_time closer to each other in the Forward Dynamics Tool setup dialog box or setup file). Open-loop forward dynamics tends to drift over time due to the accumulation of numerical errors during integration.</li><li>Forward dynamics will be slow and generate very large results files if the problem is stiff and the integrator has to take many small time steps. Some common cases that result in stiff problems:<br /><ol><li>Bodies with small masses relative to other model bodies make the system stiff. Small masses combined with large forces can also make the problem stiff.</li><li>If there's a contact model, check the settings. Try reducing the &quot;transition_velocity&quot; if forward dynamics is slow. Also having lots of damping in the contact model combined with a high stiffness value can also lead to problems. </li></ol></li><li>Having many wrapping surfaces in your model can increase computation time. Cylindrical wrapping surfaces tend to have better performance that ellipsoidal wrapping surfaces.</li></ol></p></div><div class="pageSection group"><p> </p><div class="panel" style="background-color: white;border-color: gray;border-style: solid;border-width: 5px;"><div class="panelContent" style="background-color: white;">
<p>Next: <a href="How%2BForward%2BDynamics%2BWorks.html">How Forward Dynamics Works</a></p><p>Home: <a href="Forward%2BDynamics.html">Forward Dynamics</a></p>
</div></div><p> </p> </div>
                    </div>

                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/3376188/3737101.png">ForwardToolInputOutputDiagrams.png</a> (image/png)
                                <br/>
                                                    </div>
                    </div>
                    
                                                      
                </div>             </div> 
            <div id="footer" style="background: url(http://simtk-confluence.stanford.edu:8080/images/border/border_bottom.gif) repeat-x;">
                <p><small>Document generated by Confluence on Feb 24, 2014 09:27</small></p>
            </div>
        </div>     </body>
</html>
